language: python
python:
 - "3.6"

services:
 - redis-server
 - mysql

before_install:
 - cp test.env .env
 - curl -sS https://dl.yarnpkg.com/debian/pubkey.gpg | sudo apt-key add -
 - echo "deb https://dl.yarnpkg.com/debian/ stable main" | sudo tee /etc/apt/sources.list.d/yarn.list
 - mysql -e 'CREATE DATABASE dimagidotcom_test;'

install:
 - sudo apt-get update
 - sudo apt-get install yarn
 - pip install pipenv
 - pipenv install
 - yarn install

script:
 - python manage.py test
